{"id":"brikmate-01g","title":"2.4: Stub extraction agent","description":"Create stub for key extraction agent.\n\n**Steps**:\n1. Create `src/mastra/agents/extractor.ts`\n2. Define agent with createAgent()\n3. Set prompt to extract: lessor (primary key), property address (secondary, normalize), tenant\n4. For amendments: extract reference to base lease\n\n**Code pattern**:\n```typescript\nexport const extractorAgent = createAgent({\n  name: 'key_extractor',\n  description: 'Extracts hierarchy keys from docs',\n  tools: [],\n  prompt: 'Extract lessor (primary key), property address (secondary, normalize formats/typos), tenant. For amendments, extract reference to base lease.'\n});\n```\n\n**Output**: Agent stub ready for logic implementation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T10:39:09.568692-06:00","created_by":"Reason","updated_at":"2026-01-09T11:20:58.965707-06:00","closed_at":"2026-01-09T11:17:22.204392-06:00","dependencies":[{"issue_id":"brikmate-01g","depends_on_id":"brikmate-bu8","type":"blocks","created_at":"2026-01-09T10:41:45.087902-06:00","created_by":"Reason"}]}
{"id":"brikmate-0gv","title":"Transform documentOrganizer into conversational Lease Agent","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-09T15:46:34.499682-06:00","created_by":"Reason","updated_at":"2026-01-09T15:49:11.68338-06:00","closed_at":"2026-01-09T15:49:11.68338-06:00","close_reason":"Closed"}
{"id":"brikmate-2ap","title":"Process documents sequentially to avoid rate limits","description":"The process-documents step runs all documents in parallel, causing rate limit errors due to too many tokens.\n\n**Problem**: Promise.all processes all docs simultaneously, overwhelming the API.\n\n**Solution**:\n1. Process documents one at a time (sequential loop)\n2. Add delay between requests if needed\n3. Keep the parallel classification+extraction within each document\n\n**Files**: src/mastra/workflows/organizeDocuments.ts","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-09T13:03:04.744041-06:00","created_by":"Reason","updated_at":"2026-01-09T13:05:48.066093-06:00","closed_at":"2026-01-09T13:05:48.066093-06:00","close_reason":"Closed"}
{"id":"brikmate-2cw","title":"Access documents from a specific folder","description":"Allow users to specify a folder path and read all documents from that folder for processing.\n\n**Steps**:\n1. Add folder path configuration (CLI arg or env var)\n2. Use readDocsTool to scan and read documents from the folder\n3. Support common document formats (PDF, TXT, DOCX)\n4. Return document contents for classification and extraction\n\n**Output**: Documents from specified folder loaded and ready for processing","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T11:53:30.109242-06:00","created_by":"Reason","updated_at":"2026-01-09T11:59:38.7113-06:00","closed_at":"2026-01-09T11:59:38.7113-06:00","close_reason":"Closed"}
{"id":"brikmate-2pb","title":"Phase 1: Project Setup","description":"Initialize Mastra framework. Serial execution required - foundational phase.\n\n**Goal**: Set up new Mastra project with Anthropic provider.\n\n**Subtasks**:\n- 1.1: Create Mastra project\n- 1.2: Install dependencies and verify dev server","status":"closed","priority":0,"issue_type":"feature","created_at":"2026-01-09T10:38:33.794222-06:00","created_by":"Reason","updated_at":"2026-01-09T11:00:58.548788-06:00","closed_at":"2026-01-09T11:00:58.548788-06:00","close_reason":"Closed"}
{"id":"brikmate-3b6","title":"Cache processed document results in datastore","description":"Save processed document results to avoid reprocessing on subsequent runs.\n\n**Requirements**:\n1. Store classification and extraction results per document\n2. Use document content hash as cache key\n3. Check cache before sending to LLM\n4. Skip processing if cached result exists\n5. Store results after successful processing\n\n**Benefits**:\n- Faster subsequent runs\n- Reduced API costs\n- Resume capability if workflow fails mid-run\n\n**Implementation**:\n- Use Mastra storage or simple JSON file cache\n- Hash document content for cache key\n- Store: { hash, classification, extraction, timestamp }","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-09T13:03:12.887779-06:00","created_by":"Reason","updated_at":"2026-01-09T15:10:38.710047-06:00","closed_at":"2026-01-09T15:10:38.710047-06:00","close_reason":"Closed"}
{"id":"brikmate-3u0","title":"Create dynamic per-document processing steps in workflow","description":"Refactor workflow to create individual steps for each document instead of processing all in one step.\n\n**Current**: Single 'process-documents' step handles all documents in a loop\n**Goal**: Dynamic 'process-document-{id}' step for each document\n\n**Benefits**:\n- Incremental progress visibility in Mastra Studio\n- Better resumability if workflow fails mid-run\n- Clear step-by-step execution trace\n\n**Implementation**:\n1. 'read-documents' step returns list of documents\n2. Dynamically create 'process-document-{id}' step for each\n3. Execute steps sequentially\n4. Add 30-second sleep after each document to avoid rate limits\n5. 'group-documents' step collects all results\n\n**Rate Limiting**:\n- 30 second delay between document processing\n- Prevents API rate limit errors\n\n**Files**: src/mastra/workflows/organizeDocuments.ts","status":"closed","priority":0,"issue_type":"feature","created_at":"2026-01-09T13:10:57.672932-06:00","created_by":"Reason","updated_at":"2026-01-09T13:16:31.113513-06:00","closed_at":"2026-01-09T13:16:31.113513-06:00","close_reason":"Closed"}
{"id":"brikmate-535","title":"2.3: Stub classification agent","description":"Create stub for document classification agent.\n\n**Steps**:\n1. Create `src/mastra/agents/classifier.ts`\n2. Define agent with createAgent()\n3. Set prompt to classify docs as: lease (base), amendment, rent_commencement, delivery_letter, or other\n4. Emphasize: amendments are changes to living base lease\n\n**Code pattern**:\n```typescript\nexport const classifierAgent = createAgent({\n  name: 'doc_classifier',\n  description: 'Classifies lease docs',\n  tools: [],\n  prompt: 'Classify this doc text as: lease (base), amendment, rent_commencement, delivery_letter, or other.'\n});\n```\n\n**Output**: Agent stub ready for logic implementation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T10:39:09.310874-06:00","created_by":"Reason","updated_at":"2026-01-09T11:20:58.967502-06:00","closed_at":"2026-01-09T11:17:22.177541-06:00","dependencies":[{"issue_id":"brikmate-535","depends_on_id":"brikmate-bu8","type":"blocks","created_at":"2026-01-09T10:41:44.97562-06:00","created_by":"Reason"}]}
{"id":"brikmate-536","title":"Fix Mastra observability - SQLite DB not configured for agent/tool call monitoring","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T12:02:30.022292-06:00","created_by":"Reason","updated_at":"2026-01-09T13:12:54.576857-06:00","closed_at":"2026-01-09T13:12:54.576857-06:00","close_reason":"Closed"}
{"id":"brikmate-5ll","title":"Create conversational document organizer agent","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-09T15:19:58.611704-06:00","created_by":"Reason","updated_at":"2026-01-09T15:25:12.612615-06:00","closed_at":"2026-01-09T15:25:12.612615-06:00","close_reason":"Closed"}
{"id":"brikmate-6v9","title":"3.1: Implement classification logic","description":"Implement LLM-based classification in the classifier agent.\n\n**Steps**:\n1. Integrate LLM in classifier.ts\n2. Add execute function that calls Claude\n3. Return classification: lease, amendment, rent_commencement, delivery_letter, or other\n4. For MVP: classify all docs in batch\n\n**Code pattern**:\n```typescript\nasync function classify(docText: string) {\n  const response = await llm.generate({\n    model: defaultModel,\n    messages: [{ role: 'user', content: `${prompt} Text: ${docText}` }]\n  });\n  return response.content;\n}\n```\n\n**Output**: Working classification that labels document types","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T10:40:36.712745-06:00","created_by":"Reason","updated_at":"2026-01-09T11:31:56.581922-06:00","closed_at":"2026-01-09T11:23:48.87629-06:00","dependencies":[{"issue_id":"brikmate-6v9","depends_on_id":"brikmate-535","type":"blocks","created_at":"2026-01-09T10:41:48.336704-06:00","created_by":"Reason"}]}
{"id":"brikmate-8ti","title":"Use workflow state for manual document iteration with visible steps","description":"Refactor workflow to use state-based manual iteration instead of foreach, giving visibility into each document's processing step.\n\n**Current Problem**: .foreach() shows as single long-running step in Mastra Studio\n\n**Solution**: Use workflow state to track document queue and current index, with separate steps:\n1. read-documents: Load docs into workflow state\n2. process-next-document: Process current doc, increment index\n3. check-more-documents: Conditional - loop back or continue to grouping\n4. group-documents: Final grouping step\n\n**Benefits**:\n- Each document processing visible as separate step execution\n- Clear progress tracking in UI\n- State persisted for resumability\n- 30s delay between iterations\n\n**Implementation**:\n- Use stateSchema to track: documents[], currentIndex, processedDocs[]\n- Use .dowhile() or conditional branching for iteration\n- Each iteration is a distinct step in the execution graph\n\n**Files**: src/mastra/workflows/organizeDocuments.ts","status":"closed","priority":0,"issue_type":"feature","created_at":"2026-01-09T13:40:59.370478-06:00","created_by":"Reason","updated_at":"2026-01-09T13:45:54.825308-06:00","closed_at":"2026-01-09T13:45:54.64478-06:00"}
{"id":"brikmate-94a","title":"Empty screen on Mastra dev server","description":"Mastra dev server running on port 4111 shows empty screen.\n\n**Expected**: Should show Mastra Studio UI with agents/tools\n**Actual**: Empty screen\n\n**To investigate**:\n- Check if agents/tools are exported from mastra config\n- Verify mastra instance exports correctly\n- Check browser console for errors","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T11:07:30.960839-06:00","created_by":"Reason","updated_at":"2026-01-09T11:13:59.950818-06:00","closed_at":"2026-01-09T11:13:59.950818-06:00","close_reason":"Closed"}
{"id":"brikmate-9og","title":"2.2: Define file-reading tool","description":"Create a Mastra tool to read JSON documents from a folder.\n\n**Steps**:\n1. Create `src/mastra/tools/readFiles.ts`\n2. Implement async function to read all JSON files from folder path\n3. Use fs to read/parse JSON files\n4. Wrap in Mastra tool format with name, description, execute\n\n**Code pattern**:\n```typescript\nexport const readDocsTool = {\n  name: 'read_docs',\n  description: 'Read JSON docs from folder',\n  execute: async (folderPath: string) =\u003e {\n    // Read and parse JSON files\n  }\n};\n```\n\n**Output**: Reusable tool for batch document reading","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T10:39:09.027886-06:00","created_by":"Reason","updated_at":"2026-01-09T11:20:58.968945-06:00","closed_at":"2026-01-09T11:17:22.148802-06:00","dependencies":[{"issue_id":"brikmate-9og","depends_on_id":"brikmate-bu8","type":"blocks","created_at":"2026-01-09T10:41:44.853091-06:00","created_by":"Reason"}]}
{"id":"brikmate-9z9","title":"Create Mastra tool for lease file queries","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-09T15:36:35.436976-06:00","created_by":"Reason","updated_at":"2026-01-09T15:39:56.916526-06:00","closed_at":"2026-01-09T15:39:56.916526-06:00","close_reason":"Closed"}
{"id":"brikmate-bu8","title":"2.1: Set up LLM provider in Mastra config","description":"Configure Anthropic as the LLM provider in Mastra.\n\n**Steps**:\n1. Open `src/mastra/index.ts`\n2. Import Anthropic: `import { anthropic } from '@mastra/anthropic';`\n3. Add to llmProviders config: `{ anthropic: anthropic({ apiKey: process.env.ANTHROPIC_API_KEY }) }`\n4. Set default model: `defaultModel: 'claude-3-5-sonnet-20241022'`\n\n**Output**: Mastra configured with Anthropic Claude as default LLM","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T10:39:08.710905-06:00","created_by":"Reason","updated_at":"2026-01-09T11:20:58.970311-06:00","closed_at":"2026-01-09T11:15:15.021782-06:00","dependencies":[{"issue_id":"brikmate-bu8","depends_on_id":"brikmate-c3n","type":"blocks","created_at":"2026-01-09T10:41:19.424224-06:00","created_by":"Reason"}]}
{"id":"brikmate-c3n","title":"1.2: Install deps and verify dev server","description":"Install dependencies, configure environment, and verify Mastra dev server starts.\n\n**Steps**:\n1. `cd document-organizer \u0026\u0026 npm install`\n2. Create `.env` file with `ANTHROPIC_API_KEY=your-key-here`\n3. Run `npm run dev` to verify server starts\n4. Stop server after verification\n\n**Output**: Working Mastra dev server at http://localhost:3000","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T10:38:53.55092-06:00","created_by":"Reason","updated_at":"2026-01-09T11:00:58.543664-06:00","closed_at":"2026-01-09T11:00:58.543664-06:00","close_reason":"Closed","dependencies":[{"issue_id":"brikmate-c3n","depends_on_id":"brikmate-lca","type":"blocks","created_at":"2026-01-09T10:41:12.844859-06:00","created_by":"Reason"}]}
{"id":"brikmate-duv","title":"Replace delay with human-in-the-loop step for document processing","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-09T13:52:29.037482-06:00","created_by":"Reason","updated_at":"2026-01-09T13:56:05.93424-06:00","closed_at":"2026-01-09T13:56:05.773238-06:00"}
{"id":"brikmate-egd","title":"Remove documentOrganizerAgent backward compat alias","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T15:53:41.122261-06:00","created_by":"Reason","updated_at":"2026-01-09T15:55:03.874232-06:00","closed_at":"2026-01-09T15:55:03.874232-06:00","close_reason":"Closed"}
{"id":"brikmate-g0x","title":"Refactor: Extract shared logic from workflow/tool into utils","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T15:36:30.401787-06:00","created_by":"Reason","updated_at":"2026-01-09T15:43:38.887907-06:00","closed_at":"2026-01-09T15:43:38.887907-06:00","close_reason":"Closed"}
{"id":"brikmate-l49","title":"Phase 2: Core Configuration","description":"Configure LLM provider and stub agents/tools. Parallel execution possible for tool/agent definitions after LLM setup.\n\n**Goal**: Set up Anthropic LLM and create stubs for classification agent, extraction agent, and file-reading tool.\n\n**Subtasks**:\n- 2.1: Set up LLM provider (serial)\n- 2.2: Define file-reading tool (parallel)\n- 2.3: Stub classification agent (parallel)\n- 2.4: Stub extraction agent (parallel)","status":"closed","priority":0,"issue_type":"feature","created_at":"2026-01-09T10:38:40.353309-06:00","created_by":"Reason","updated_at":"2026-01-09T11:20:58.972366-06:00","closed_at":"2026-01-09T11:17:22.230275-06:00","dependencies":[{"issue_id":"brikmate-l49","depends_on_id":"brikmate-2pb","type":"blocks","created_at":"2026-01-09T10:42:02.790925-06:00","created_by":"Reason"}]}
{"id":"brikmate-lca","title":"1.1: Create Mastra project","description":"Run `npm create mastra@latest document-organizer --no-example` to initialize project.\n\n**Steps**:\n1. Run: `npm create mastra@latest document-organizer --no-example`\n2. Accept defaults (TypeScript, Node.js)\n3. Verify project structure created\n\n**Output**: Fresh Mastra project directory with TypeScript config","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T10:38:53.323285-06:00","created_by":"Reason","updated_at":"2026-01-09T10:55:15.573437-06:00","closed_at":"2026-01-09T10:55:15.573437-06:00","close_reason":"Closed"}
{"id":"brikmate-pny","title":"Add chunked processing for large documents","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-09T16:12:43.655229-06:00","created_by":"Reason","updated_at":"2026-01-09T16:18:23.912992-06:00","closed_at":"2026-01-09T16:18:23.912992-06:00","close_reason":"Closed"}
{"id":"brikmate-qhy","title":"3.3: Create hierarchical grouping workflow","description":"Create the main workflow that orchestrates all components and outputs nested JSON.\n\n**Steps**:\n1. Install string-similarity: `npm i string-similarity`\n2. Define workflow in src/mastra/index.ts\n3. Implement grouping step with fuzzy matching (\u003e80% similarity)\n4. Group by: lessor → address → leaseFile\n5. Within leaseFile: baseLease, amendments[], commencements[], deliveries[], others[]\n6. Log ungrouped docs for review\n\n**Output Structure**:\n```json\n{\n  \"lessor1\": {\n    \"address1\": {\n      \"leaseFile\": {\n        \"baseLease\": \"docId\",\n        \"amendments\": [\"docId\",...],\n        \"commencements\": [\"docId\",...],\n        \"deliveries\": [\"docId\",...],\n        \"others\": [\"docId\",...]\n      }\n    }\n  }\n}\n```\n\n**Key Logic**:\n- Fuzzy match lessors (\u003e80% similarity)\n- Fuzzy match normalized addresses\n- Identify base lease (classified as 'lease')\n- Append amendments sorted by date/effective date\n- Link commencements/deliveries by matching keys\n\n**Output**: Complete MVP workflow producing nested JSON","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T10:40:40.429741-06:00","created_by":"Reason","updated_at":"2026-01-09T12:17:39.340413-06:00","closed_at":"2026-01-09T12:17:39.340413-06:00","close_reason":"Closed","dependencies":[{"issue_id":"brikmate-qhy","depends_on_id":"brikmate-6v9","type":"blocks","created_at":"2026-01-09T10:41:48.779029-06:00","created_by":"Reason"},{"issue_id":"brikmate-qhy","depends_on_id":"brikmate-t45","type":"blocks","created_at":"2026-01-09T10:41:48.981978-06:00","created_by":"Reason"}]}
{"id":"brikmate-t45","title":"3.2: Implement key extraction logic","description":"Implement LLM-based key extraction with Zod schema validation.\n\n**Steps**:\n1. Install zod: `npm i zod`\n2. Define extraction schema in extractor.ts\n3. Implement execute function to extract structured keys\n4. Normalize addresses (e.g., '123 Main St.' → '123 main street')\n5. For amendments: extract baseReference to link to lease file\n\n**Zod Schema**:\n```typescript\nz.object({\n  lessor: z.string(),\n  address: z.string(),\n  tenant: z.string(),\n  baseReference: z.string().optional()\n})\n```\n\n**Output**: Structured key extraction with normalized values","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T10:40:37.043704-06:00","created_by":"Reason","updated_at":"2026-01-09T11:32:02.043117-06:00","closed_at":"2026-01-09T11:32:02.043117-06:00","close_reason":"Closed","dependencies":[{"issue_id":"brikmate-t45","depends_on_id":"brikmate-01g","type":"blocks","created_at":"2026-01-09T10:41:48.594024-06:00","created_by":"Reason"}]}
{"id":"brikmate-v0p","title":"Add lease file query API for exploring cached documents","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-09T15:23:28.299055-06:00","created_by":"Reason","updated_at":"2026-01-09T15:33:53.906908-06:00","closed_at":"2026-01-09T15:33:53.906908-06:00","close_reason":"Closed"}
{"id":"brikmate-xnv","title":"Phase 3: Core Logic Implementation","description":"Implement agent logic and hierarchical grouping workflow. Classification and extraction can run in parallel; grouping is serial after both complete.\n\n**Goal**: Working MVP that reads docs, extracts keys, classifies, and outputs nested JSON.\n\n**Output Structure**:\n```json\n{\n  \"lessor1\": {\n    \"address1\": {\n      \"leaseFile\": {\n        \"baseLease\": \"docId\",\n        \"amendments\": [\"docId\",...],\n        \"commencements\": [\"docId\",...],\n        \"deliveries\": [\"docId\",...],\n        \"others\": [\"docId\",...]\n      }\n    }\n  }\n}\n```\n\n**Subtasks**:\n- 3.1: Implement classification logic (parallel)\n- 3.2: Implement key extraction logic (parallel)\n- 3.3: Create hierarchical grouping workflow (serial after 3.1+3.2)","status":"open","priority":0,"issue_type":"feature","created_at":"2026-01-09T10:38:46.078677-06:00","created_by":"Reason","updated_at":"2026-01-09T10:38:46.078677-06:00","dependencies":[{"issue_id":"brikmate-xnv","depends_on_id":"brikmate-l49","type":"blocks","created_at":"2026-01-09T10:42:02.919192-06:00","created_by":"Reason"}]}
